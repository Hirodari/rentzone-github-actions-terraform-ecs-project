create repo: rentzone-github-actions-terraform-ecs-project
clone the repo
download the zip folder: iac and unzip it
link: [https://github.com/azeezsalu/aosnote-projects/blob/main/cicd-projects/
        rentzone-github-actions-terraform-ecs-project/iac.zip]
copy iac folder => rentzone-github-actions-terraform-ecs-project
create an s3 bucket: mitsindo-terraform-remote-state => enable versioning
create dynamodb table: terraform-state-lock => LockID
set up secret manager on the console
register a domain name 
update the backend.tf with value
update terraform.tfvars
generate github tokens: clone-repository => check repo
create github repository secrets
    settings -> secrets and variables -> actions -> new repo secret 
    AWS_ACCESS_KEY_ID: AKIA3DRWTYPDKFG2DEAE
    AWS_SECRET_ACCESS_KEY: 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
    ECR_REGISTRY: 763544978374.dkr.ecr.us-east-1.amazonaws.com
    PERSONAL_ACCESS_TOKEN: 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
    RDS_DB_NAME: applicationdb
    RDS_DB_PASSWORD: admin123
    RDS_DB_USERNAME:admin
create workflow file
    pre-requisites: it needs to be a yaml file stored in your repo => .github/workflows
    filename: deploy_pipeline.yml 
    link: [https://github.com/azeezsalu/aosnote-projects/blob/main/cicd-projects
    /rentzone-github-actions-terraform-ecs-project/configure_aws_credentials_reference.yml]
    this file will have all configs and instructions to create a deployment Pipeline
    1. instruct on push to trigger the pipeline, code:
        on:
            push:
                branches: [main]
    2. set up env:
        env:
            AWS_ACCESS_KEY_ID: ${{ secrets.AWS_ACCESS_KEY_ID }}
            AWS_SECRET_ACCESS_KEY: ${{ secrets.AWS_SECRET_ACCESS_KEY }}
            AWS_REGION: us-east-1
            TERRAFORM_ACTION: destroy
    3. create jobs, the job will have 3 tasks: configure_aws_credentials, deploy_aws_infrastructure 
       and create_ecr_repository
       link: [https://github.com/azeezsalu/aosnote-projects/blob/main/cicd-projects/
            rentzone-github-actions-terraform-ecs-project/create_ecr_repository_reference.yml]
create a self hosted runner:
    this steps consist of creating an ec2 server on default vpc and public sublic where we can ssh
    os: amazon linux 2
    tag: Github Actions Runner
    purpose: to create an ami/snapshot where git and docker are installed
    reference: https://github.com/machulav/ec2-github-runner
    insteall git and docker:
    sudo yum update -y && \
    sudo yum install docker -y && \
    sudo yum install git -y && \
    sudo yum install libicu -y && \
    sudo systemctl enable docker
terminate self hosted runner

create github actions job to start a self hosted runner 
    link: [https://github.com/azeezsalu/aosnote-projects/blob/main/cicd-projects/
        rentzone-github-actions-terraform-ecs-project/start_runner_reference.yml]
    PERSONAL_ACCESS_TOKEN: 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
create a repository to store the code 
    name: github-actions-application-codes
upload the application code to the repo 
    link: https://drive.google.com/file/d/170QhMrG5xtE2Krh5O_DsjI1B1FtA3zH_/view
to upload a large file > 50MB do the following:
link: [https://git-lfs.com/]
git lfs install
git lfs track "*.psd"
git add .gitattributes
git add file.psd
git commit -m "Add design file"
git push origin main
create Dockerfile
    the docker file should at the root of rentzone-github-actions-terraform-ecs-project
    copy the reference: [https://github.com/azeezsalu/aosnote-projects/blob/main/cicd-projects/
                        rentzone-github-actions-terraform-ecs-project/Dockerfile]
create the appserviceprovider.php file
    link: [https://github.com/azeezsalu/aosnote-projects/blob/main/cicd-projects/
            rentzone-github-actions-terraform-ecs-project/AppServiceProvider.php]
create a github actions job to build and push a docker image into amazon ecr
    add variables on deploy_pipeline.yml
    link: [https://github.com/azeezsalu/aosnote-projects/blob/main/cicd-projects/
            rentzone-github-actions-terraform-ecs-project/build%20docker%20image%20variables.txt]
          [https://github.com/azeezsalu/aosnote-projects/blob/main/cicd-projects/
            rentzone-github-actions-terraform-ecs-project/build_and_push_image_reference.yml]
    